<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Паттерн Revealing Constructor - открытый конструктор - Patterns</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-ae938929.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-14213fa4.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-d959ff8c.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">Patterns</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="паттерн-revealing-constructor-открытый-конструктор"><a class="header" href="#паттерн-revealing-constructor-открытый-конструктор">Паттерн Revealing Constructor (Открытый конструктор)</a></h1>
<h2 id="обзор"><a class="header" href="#обзор">Обзор</a></h2>
<p>Паттерн <strong>Revealing Constructor</strong> (Открытый конструктор) — это паттерн проектирования, который позволяет инициализировать объект через функцию, передаваемую в конструктор. Этот паттерн необходим для понимания работы Promise и построения более сложных абстракций для работы с асинхронностью, таких как паттерн Future (без состояния и многоразовый, в отличие от Promise).</p>
<p><strong>Основная идея:</strong> Функция попадает в конструктор и инициализирует экземпляр объекта, изменяя его поведение или внедряя зависимости.</p>
<hr>
<h2 id="три-способа-передачи-значений-в-функцию"><a class="header" href="#три-способа-передачи-значений-в-функцию">Три способа передачи значений в функцию</a></h2>
<p>Прежде чем перейти к паттерну, рассмотрим три различных способа передачи значений внутрь функции:</p>
<h3 id="пример-различные-способы-передачи-данных"><a class="header" href="#пример-различные-способы-передачи-данных">Пример: Различные способы передачи данных</a></h3>
<pre><code class="language-javascript">// Три способа передачи значений
const example = (x, y, z) =&gt; {
  // 1. Константа - прямое значение
  console.log(x); // Обращаемся напрямую к переменной

  // 2. Функция, возвращающая константу
  console.log(y()); // Вызываем функцию для получения значения

  // 3. Callback-функция
  z((value) =&gt; {
    console.log(value); // Значение приходит через callback
  });
};

// Вызов с различными типами аргументов
example(
  5,                    // 1. Просто константа
  () =&gt; 10,            // 2. Функция, возвращающая значение
  (callback) =&gt; {      // 3. Функция, принимающая callback
    callback(15);
  }
);
</code></pre>
<p><strong>Вывод:</strong></p>
<ul>
<li><strong>Первый способ (константа):</strong> Самый простой, значение передаётся напрямую</li>
<li><strong>Второй способ (функция):</strong> Позволяет отложить вычисление значения</li>
<li><strong>Третий способ (callback):</strong> Позволяет асинхронно вернуть значение в будущем</li>
</ul>
<hr>
<h2 id="применение-паттерна-в-promise"><a class="header" href="#применение-паттерна-в-promise">Применение паттерна в Promise</a></h2>
<p>Именно <strong>третий способ</strong> (callback) используется в конструкторе Promise и является примером паттерна Revealing Constructor.</p>
<h3 id="пример-promise-с-revealing-constructor"><a class="header" href="#пример-promise-с-revealing-constructor">Пример: Promise с Revealing Constructor</a></h3>
<pre><code class="language-javascript">// Promise использует паттерн Revealing Constructor
const promise1 = new Promise((resolve, reject) =&gt; {
  // Сразу разрешаем промис
  resolve(5);
});

const promise2 = new Promise((resolve, reject) =&gt; {
  // Ждём секунду, затем разрешаем
  setTimeout(() =&gt; {
    resolve(5);
  }, 1000);
});

// Первый слушатель - навешивается ДО разрешения промиса
promise2.then((x) =&gt; {
  console.log('First listener:', x);
});

// Ждём 1.5 секунды
setTimeout(() =&gt; {
  // Второй слушатель - навешивается ПОСЛЕ разрешения промиса
  promise2.then((y) =&gt; {
    console.log('Second listener:', y);
  });
}, 1500);

console.log(promise2); // Promise { &lt;pending&gt; }
</code></pre>
<p><strong>Результат выполнения:</strong></p>
<pre><code>Promise { &lt;pending&gt; }
First listener: 5
Second listener: 5
</code></pre>
<h3 id="почему-promise-нужен-именно-callback"><a class="header" href="#почему-promise-нужен-именно-callback">Почему Promise нужен именно callback?</a></h3>
<p><strong>Ключевой момент:</strong> Если бы в Promise передавали просто константу или функцию, возвращающую константу, мы не смогли бы:</p>
<ol>
<li><strong>Отложить разрешение промиса</strong> (подождать секунду в примере выше)</li>
<li><strong>Переводить промис из состояния pending</strong> в resolved или rejected</li>
<li><strong>Подписываться на значение до и после его разрешения</strong></li>
</ol>
<pre><code class="language-javascript">// ❌ Это НЕ сработало бы:
const badPromise = new Promise(() =&gt; {
  return 5; // return сразу вернул бы значение,
            // не дав возможности асинхронно разрешить промис
});

// ✅ Правильный способ - через callback (resolve/reject):
const goodPromise = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    resolve(5); // Асинхронное разрешение через callback
  }, 1000);
});
</code></pre>
<hr>
<h2 id="применение-паттерна-в-nodejs-streams"><a class="header" href="#применение-паттерна-в-nodejs-streams">Применение паттерна в Node.js Streams</a></h2>
<p>Паттерн Revealing Constructor широко используется в стримах Node.js, позволяя избежать наследования классов.</p>
<h3 id="традиционный-подход-наследование-через-extends"><a class="header" href="#традиционный-подход-наследование-через-extends">Традиционный подход: Наследование через extends</a></h3>
<pre><code class="language-javascript">const { Readable } = require('node:stream');

// Создаём класс RandomStream, наследуясь от Readable
class RandomStream extends Readable {
  _read(size) {
    // Генерируем массив случайных байтов нужной длины
    const chunk = Buffer.allocUnsafe(size)
      .map(() =&gt; Math.floor(Math.random() * 256));

    // Преобразуем в шестнадцатеричную строку
    const hexString = chunk.toString('hex');

    // Отправляем данные в буфер стрима
    this.push(hexString);
  }
}

// Использование
const randomStream = new RandomStream();
randomStream.on('data', (chunk) =&gt; {
  console.log(chunk);
});
</code></pre>
<h3 id="современный-подход-revealing-constructor"><a class="header" href="#современный-подход-revealing-constructor">Современный подход: Revealing Constructor</a></h3>
<pre><code class="language-javascript">const { Readable } = require('node:stream');

// Создаём Readable stream БЕЗ наследования
const randomStream = new Readable({
  read(size) {
    // Генерируем массив случайных байтов
    const chunk = Buffer.allocUnsafe(size)
      .map(() =&gt; Math.floor(Math.random() * 256));

    // Преобразуем в шестнадцатеричную строку
    const hexString = chunk.toString('hex');

    // Отправляем данные в буфер
    this.push(hexString);
  }
});

// Использование точно такое же
randomStream.on('data', (chunk) =&gt; {
  console.log(chunk);
});
</code></pre>
<p><strong>Преимущества Revealing Constructor в стримах:</strong></p>
<ol>
<li><strong>Нет необходимости создавать отдельный класс</strong></li>
<li><strong>Более компактный код</strong></li>
<li><strong>Внедрение зависимостей</strong> - метод <code>read</code> инжектится внутрь экземпляра Readable</li>
<li><strong>Именно так реализованы стримы в стандартной библиотеке Node.js</strong></li>
</ol>
<h3 id="практический-пример-pipe-в-stdout"><a class="header" href="#практический-пример-pipe-в-stdout">Практический пример: Pipe в stdout</a></h3>
<pre><code class="language-javascript">const { Readable } = require('node:stream');

const randomStream = new Readable({
  read(size) {
    const chunk = Buffer.allocUnsafe(size)
      .map(() =&gt; Math.floor(Math.random() * 256));
    this.push(chunk.toString('hex') + '\n');
  }
});

// Pipe в stdout для бесконечного вывода случайных чисел
randomStream.pipe(process.stdout);
// Генерирует и выводит бесконечный поток случайных hex-строк
</code></pre>
<p><strong>Почему это работает:</strong></p>
<ul>
<li>Как только происходит <code>pipe</code>, Readable начинает вызывать метод <code>read</code></li>
<li>Метод <code>read</code> генерирует данные и пушит их в буфер через <code>this.push()</code></li>
<li>Данные автоматически передаются в Writable stream (stdout)</li>
</ul>
<hr>
<h2 id="другие-типы-стримов-с-revealing-constructor"><a class="header" href="#другие-типы-стримов-с-revealing-constructor">Другие типы стримов с Revealing Constructor</a></h2>
<h3 id="transform-stream"><a class="header" href="#transform-stream">Transform Stream</a></h3>
<h4 id="традиционный-подход-с-наследованием"><a class="header" href="#традиционный-подход-с-наследованием">Традиционный подход с наследованием:</a></h4>
<pre><code class="language-javascript">const { Transform } = require('node:stream');

// Стрим, который делает все буквы заглавными
class UpperCaseTransform extends Transform {
  _transform(chunk, encoding, callback) {
    // Преобразуем chunk в заглавные буквы
    const upperChunk = chunk.toString().toUpperCase();
    // Передаём результат дальше
    callback(null, upperChunk);
  }
}

// Использование
const upperTransform = new UpperCaseTransform();
process.stdin
  .pipe(upperTransform)
  .pipe(process.stdout);
</code></pre>
<h4 id="revealing-constructor-подход"><a class="header" href="#revealing-constructor-подход">Revealing Constructor подход:</a></h4>
<pre><code class="language-javascript">const { Transform } = require('node:stream');

// Создаём Transform stream без наследования
const upperTransform = new Transform({
  transform(chunk, encoding, callback) {
    // Преобразуем chunk в заглавные буквы
    const upperChunk = chunk.toString().toUpperCase();
    // Передаём результат дальше
    callback(null, upperChunk);
  }
});

// Использование - абсолютно идентично
process.stdin
  .pipe(upperTransform)
  .pipe(process.stdout);
</code></pre>
<h3 id="writable-stream"><a class="header" href="#writable-stream">Writable Stream</a></h3>
<pre><code class="language-javascript">const { Writable } = require('node:stream');

// Создаём Writable stream через Revealing Constructor
const myWritable = new Writable({
  write(chunk, encoding, callback) {
    console.log('Received:', chunk.toString());
    callback(); // Сигнализируем о завершении записи
  }
});
</code></pre>
<h3 id="duplex-stream"><a class="header" href="#duplex-stream">Duplex Stream</a></h3>
<pre><code class="language-javascript">const { Duplex } = require('node:stream');

// Для Duplex нужно определить и read, и write
const myDuplex = new Duplex({
  read(size) {
    // Логика чтения
    this.push('data');
  },
  write(chunk, encoding, callback) {
    // Логика записи
    console.log(chunk.toString());
    callback();
  }
});
</code></pre>
<hr>
<h2 id="создание-собственных-абстракций-с-revealing-constructor"><a class="header" href="#создание-собственных-абстракций-с-revealing-constructor">Создание собственных абстракций с Revealing Constructor</a></h2>
<p>Паттерн можно использовать не только для Promise и стримов, но и для создания собственных абстракций.</p>
<h3 id="пример-класс-timer"><a class="header" href="#пример-класс-timer">Пример: Класс Timer</a></h3>
<pre><code class="language-javascript">class Timer {
  constructor(interval, listener) {
    this.interval = interval;  // Интервал в миллисекундах
    this.listener = listener;  // Функция-обработчик
    this.timerId = null;       // ID таймера
  }

  start() {
    // Запускаем setInterval с переданной функцией
    this.timerId = setInterval(this.listener, this.interval);
  }

  stop() {
    // Останавливаем таймер
    if (this.timerId) {
      clearInterval(this.timerId);
      this.timerId = null;
    }
  }
}

// Использование
const timer = new Timer(1000, () =&gt; {
  console.log('Timer event');
});

timer.start(); // Начинаем вызов каждую секунду

setTimeout(() =&gt; {
  timer.stop(); // Останавливаем через 5 секунд
}, 5000);
</code></pre>
<p><strong>Результат выполнения:</strong></p>
<pre><code>Timer event
Timer event
Timer event
Timer event
</code></pre>
<p>(4 события за ~5 секунд)</p>
<p><strong>Особенности паттерна в Timer:</strong></p>
<ul>
<li>Функция <code>listener</code> передаётся в конструктор</li>
<li>Хранится внутри экземпляра объекта</li>
<li>Используется вместо метода, который можно было бы переопределить</li>
<li>Изменяет поведение базового функционала (setInterval)</li>
</ul>
<hr>
<h2 id="различные-формы-передачи-функций-в-revealing-constructor"><a class="header" href="#различные-формы-передачи-функций-в-revealing-constructor">Различные формы передачи функций в Revealing Constructor</a></h2>
<h3 id="форма-1-прямая-передача-функции-promise-timer"><a class="header" href="#форма-1-прямая-передача-функции-promise-timer">Форма 1: Прямая передача функции (Promise, Timer)</a></h3>
<pre><code class="language-javascript">// Promise
new Promise((resolve, reject) =&gt; {
  // resolve и reject - это callbacks
});

// Timer
new Timer(1000, () =&gt; {
  // Функция передаётся напрямую
});
</code></pre>
<h3 id="форма-2-передача-через-объект-streams"><a class="header" href="#форма-2-передача-через-объект-streams">Форма 2: Передача через объект (Streams)</a></h3>
<pre><code class="language-javascript">// Readable Stream
new Readable({
  read(size) {
    // Функция передаётся как метод объекта
  }
});

// Transform Stream
new Transform({
  transform(chunk, encoding, callback) {
    // Именованная функция в объекте
  }
});

// Duplex Stream
new Duplex({
  read(size) { /* ... */ },
  write(chunk, encoding, callback) { /* ... */ }
});
</code></pre>
<hr>
<h2 id="ключевые-концепции-паттерна"><a class="header" href="#ключевые-концепции-паттерна">Ключевые концепции паттерна</a></h2>
<h3 id="1-внедрение-зависимостей-dependency-injection"><a class="header" href="#1-внедрение-зависимостей-dependency-injection">1. Внедрение зависимостей (Dependency Injection)</a></h3>
<p>Revealing Constructor очень похож на внедрение зависимостей, только:</p>
<ul>
<li><strong>Внедряется одна или несколько функций</strong> внутрь экземпляра</li>
<li><strong>Функции изменяют поведение</strong> базового класса</li>
<li><strong>Альтернатива наследованию</strong> классов</li>
</ul>
<pre><code class="language-javascript">// Вместо наследования:
class MyStream extends Readable {
  _read(size) { /* ... */ }
}

// Используем внедрение через конструктор:
const myStream = new Readable({
  read(size) { /* ... */ }
});
</code></pre>
<h3 id="2-инициализация-состояния-объекта"><a class="header" href="#2-инициализация-состояния-объекта">2. Инициализация состояния объекта</a></h3>
<p>Переданная функция может:</p>
<ul>
<li>Изменять внутреннее состояние объекта</li>
<li>Переводить объект из одного состояния в другое (pending → fulfilled/rejected в Promise)</li>
<li>Управлять жизненным циклом объекта</li>
</ul>
<h3 id="3-асинхронное-управление"><a class="header" href="#3-асинхронное-управление">3. Асинхронное управление</a></h3>
<p>Паттерн позволяет:</p>
<ul>
<li>Откладывать выполнение операций</li>
<li>Работать с асинхронными операциями</li>
<li>Подписываться на события до и после их наступления</li>
</ul>
<hr>
<h2 id="преимущества-паттерна"><a class="header" href="#преимущества-паттерна">Преимущества паттерна</a></h2>
<h3 id="1-инкапсуляция"><a class="header" href="#1-инкапсуляция">1. Инкапсуляция</a></h3>
<pre><code class="language-javascript">// Внутренние методы (resolve/reject) доступны
// только внутри функции-конструктора
new Promise((resolve, reject) =&gt; {
  // resolve и reject доступны ТОЛЬКО здесь
  setTimeout(() =&gt; resolve(42), 1000);
});

// Снаружи нельзя напрямую вызвать resolve или reject
</code></pre>
<h3 id="2-гибкость"><a class="header" href="#2-гибкость">2. Гибкость</a></h3>
<pre><code class="language-javascript">// Можно передать любую логику инициализации
const stream1 = new Readable({
  read() { this.push('simple data'); }
});

const stream2 = new Readable({
  read(size) {
    // Сложная логика с асинхронными операциями
    fetchData().then(data =&gt; this.push(data));
  }
});
</code></pre>
<h3 id="3-избежание-наследования"><a class="header" href="#3-избежание-наследования">3. Избежание наследования</a></h3>
<pre><code class="language-javascript">// Не нужно создавать класс для каждого случая
// Плохо:
class SimpleReadable extends Readable { _read() { /* ... */ } }
class ComplexReadable extends Readable { _read() { /* ... */ } }
class AnotherReadable extends Readable { _read() { /* ... */ } }

// Хорошо:
const simple = new Readable({ read() { /* ... */ } });
const complex = new Readable({ read() { /* ... */ } });
const another = new Readable({ read() { /* ... */ } });
</code></pre>
<h3 id="4-контроль-доступа"><a class="header" href="#4-контроль-доступа">4. Контроль доступа</a></h3>
<pre><code class="language-javascript">// Promise открывает только resolve/reject внутри конструктора
// но не даёт доступ к ним извне
const promise = new Promise((resolve, reject) =&gt; {
  // Только здесь можно управлять состоянием
  setTimeout(() =&gt; resolve('done'), 1000);
});

// promise.resolve() - ❌ Такого метода нет!
// promise.reject()  - ❌ Такого метода нет!
</code></pre>
<hr>
<h2 id="сравнение-подходов"><a class="header" href="#сравнение-подходов">Сравнение подходов</a></h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Аспект</th><th>Наследование (extends)</th><th>Revealing Constructor</th></tr>
</thead>
<tbody>
<tr><td><strong>Создание класса</strong></td><td>Требуется</td><td>Не требуется</td></tr>
<tr><td><strong>Многословность</strong></td><td>Больше кода</td><td>Компактнее</td></tr>
<tr><td><strong>Переиспользование</strong></td><td>Через иерархию классов</td><td>Через композицию функций</td></tr>
<tr><td><strong>Гибкость</strong></td><td>Ограничена иерархией</td><td>Высокая</td></tr>
<tr><td><strong>Инкапсуляция</strong></td><td>Через приватные поля</td><td>Через замыкания</td></tr>
</tbody>
</table>
</div>
<h3 id="пример-сравнения-для-стримов"><a class="header" href="#пример-сравнения-для-стримов">Пример сравнения для стримов:</a></h3>
<pre><code class="language-javascript">// Подход 1: Наследование (многословно)
class RandomStream extends Readable {
  constructor(options) {
    super(options);
  }
  _read(size) {
    const chunk = Buffer.allocUnsafe(size)
      .map(() =&gt; Math.floor(Math.random() * 256));
    this.push(chunk.toString('hex'));
  }
}
const stream1 = new RandomStream();

// Подход 2: Revealing Constructor (компактно)
const stream2 = new Readable({
  read(size) {
    const chunk = Buffer.allocUnsafe(size)
      .map(() =&gt; Math.floor(Math.random() * 256));
    this.push(chunk.toString('hex'));
  }
});
</code></pre>
<hr>
<h2 id="применение-в-реальных-проектах"><a class="header" href="#применение-в-реальных-проектах">Применение в реальных проектах</a></h2>
<h3 id="1-promise-api"><a class="header" href="#1-promise-api">1. Promise API</a></h3>
<p>Все промисы используют этот паттерн:</p>
<pre><code class="language-javascript">// Работа с файлами
const filePromise = new Promise((resolve, reject) =&gt; {
  fs.readFile('file.txt', (err, data) =&gt; {
    if (err) reject(err);
    else resolve(data);
  });
});

// HTTP запросы
const httpPromise = new Promise((resolve, reject) =&gt; {
  http.get('http://api.example.com', (res) =&gt; {
    let data = '';
    res.on('data', chunk =&gt; data += chunk);
    res.on('end', () =&gt; resolve(data));
    res.on('error', reject);
  });
});
</code></pre>
<h3 id="2-nodejs-streams"><a class="header" href="#2-nodejs-streams">2. Node.js Streams</a></h3>
<p>Стандартная библиотека Node.js реализует все типы стримов с поддержкой Revealing Constructor:</p>
<pre><code class="language-javascript">const { Readable, Writable, Transform, Duplex } = require('node:stream');

// Все эти конструкторы принимают объекты с функциями
const r = new Readable({ read() { /* ... */ } });
const w = new Writable({ write() { /* ... */ } });
const t = new Transform({ transform() { /* ... */ } });
const d = new Duplex({ read() { /* ... */ }, write() { /* ... */ } });
</code></pre>
<h3 id="3-custom-event-emitters"><a class="header" href="#3-custom-event-emitters">3. Custom Event Emitters</a></h3>
<pre><code class="language-javascript">class Emitter {
  constructor(listener) {
    this.listener = listener;
    this.events = {};
  }

  emit(event, data) {
    if (this.listener) {
      this.listener(event, data);
    }
  }
}

const emitter = new Emitter((event, data) =&gt; {
  console.log(`Event ${event}:`, data);
});

emitter.emit('message', 'Hello!');
</code></pre>
<hr>
<h2 id="связь-с-паттерном-future"><a class="header" href="#связь-с-паттерном-future">Связь с паттерном Future</a></h2>
<p>Паттерн Revealing Constructor будет использован для создания паттерна <strong>Future</strong> в следующей лекции:</p>
<p><strong>Отличия Future от Promise:</strong></p>
<ul>
<li><strong>Без состояния</strong> (stateless)</li>
<li><strong>Многоразовый</strong> (можно использовать повторно)</li>
<li><strong>Из функционального программирования</strong></li>
<li><strong>Компонуемый</strong> (легко комбинируется)</li>
</ul>
<pre><code class="language-javascript">// Пример концепции (упрощённо)
class Future {
  constructor(computation) {
    this.computation = computation; // Сохраняем вычисление
  }

  fork(reject, resolve) {
    // Каждый раз запускаем вычисление заново
    this.computation(reject, resolve);
  }
}

// Future можно запустить многократно
const future = new Future((reject, resolve) =&gt; {
  setTimeout(() =&gt; resolve(42), 1000);
});

future.fork(console.error, console.log); // Первый запуск
future.fork(console.error, console.log); // Второй запуск
</code></pre>
<hr>
<h2 id="практические-рекомендации"><a class="header" href="#практические-рекомендации">Практические рекомендации</a></h2>
<h3 id="когда-использовать-revealing-constructor"><a class="header" href="#когда-использовать-revealing-constructor">Когда использовать Revealing Constructor</a></h3>
<p>✅ <strong>Используйте когда:</strong></p>
<ul>
<li>Нужно внедрить поведение в конструктор объекта</li>
<li>Требуется инкапсулировать внутренние методы</li>
<li>Хотите избежать создания множества классов через наследование</li>
<li>Работаете с асинхронными операциями</li>
<li>Нужно управлять состоянием объекта извне конструктора</li>
</ul>
<p>❌ <strong>Не используйте когда:</strong></p>
<ul>
<li>Логика слишком сложная для одной функции</li>
<li>Нужна полноценная иерархия классов</li>
<li>Требуется множественное наследование поведения</li>
<li>Важна типизация и IDE поддержка (без TypeScript)</li>
</ul>
<h3 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h3>
<pre><code class="language-javascript">// ✅ Хорошо: Явные имена параметров
new Promise((resolve, reject) =&gt; {
  // Понятно, что делают эти функции
});

// ✅ Хорошо: Документированные методы объекта
new Readable({
  read(size) {
    // size - понятный параметр
  }
});

// ❌ Плохо: Неясные имена
new SomeClass((a, b) =&gt; {
  // Что такое a и b?
});

// ✅ Хорошо: Обработка ошибок
new Promise((resolve, reject) =&gt; {
  try {
    // ... операция
    resolve(result);
  } catch (error) {
    reject(error);
  }
});
</code></pre>
<hr>
<h2 id="резюме"><a class="header" href="#резюме">Резюме</a></h2>
<h3 id="основные-концепции"><a class="header" href="#основные-концепции">Основные концепции</a></h3>
<ol>
<li><strong>Revealing Constructor</strong> - паттерн, при котором функция передаётся в конструктор для инициализации объекта</li>
<li><strong>Три способа передачи данных</strong>: константа, функция возвращающая значение, callback-функция</li>
<li><strong>Promise использует Revealing Constructor</strong> для управления состоянием (resolve/reject)</li>
<li><strong>Node.js Streams</strong> используют этот паттерн для внедрения методов read/write/transform</li>
<li><strong>Альтернатива наследованию</strong> - можно избежать создания классов</li>
</ol>
<h3 id="ключевые-преимущества"><a class="header" href="#ключевые-преимущества">Ключевые преимущества</a></h3>
<ul>
<li>✅ Инкапсуляция внутренних методов</li>
<li>✅ Гибкость в настройке поведения</li>
<li>✅ Компактный код без наследования</li>
<li>✅ Внедрение зависимостей через конструктор</li>
<li>✅ Поддержка асинхронных операций</li>
</ul>
<h3 id="области-применения"><a class="header" href="#области-применения">Области применения</a></h3>
<ul>
<li>Promise API</li>
<li>Node.js Streams (Readable, Writable, Transform, Duplex)</li>
<li>Custom таймеры и планировщики</li>
<li>Event Emitters</li>
<li>Паттерн Future (следующая тема)</li>
</ul>
<h3 id="следующие-шаги"><a class="header" href="#следующие-шаги">Следующие шаги</a></h3>
<p>В следующей лекции мы построим паттерн <strong>Future</strong> на основе Revealing Constructor:</p>
<ul>
<li>Без состояния (в отличие от Promise)</li>
<li>Многоразовый</li>
<li>Из функционального программирования</li>
<li>Для работы с асинхронностью</li>
</ul>
<hr>
<h2 id="дополнительные-примеры-для-практики"><a class="header" href="#дополнительные-примеры-для-практики">Дополнительные примеры для практики</a></h2>
<h3 id="пример-1-observable-подобный-класс"><a class="header" href="#пример-1-observable-подобный-класс">Пример 1: Observable-подобный класс</a></h3>
<pre><code class="language-javascript">class Observable {
  constructor(subscriber) {
    this.subscriber = subscriber;
  }

  subscribe(observer) {
    return this.subscriber(observer);
  }
}

// Использование
const observable = new Observable((observer) =&gt; {
  let count = 0;
  const interval = setInterval(() =&gt; {
    observer.next(count++);
    if (count &gt; 5) {
      observer.complete();
      clearInterval(interval);
    }
  }, 1000);

  // Функция отписки
  return () =&gt; clearInterval(interval);
});

const unsubscribe = observable.subscribe({
  next: (value) =&gt; console.log('Value:', value),
  complete: () =&gt; console.log('Complete!')
});
</code></pre>
<h3 id="пример-2-retry-механизм"><a class="header" href="#пример-2-retry-механизм">Пример 2: Retry механизм</a></h3>
<pre><code class="language-javascript">class Retryable {
  constructor(operation, maxRetries = 3) {
    this.operation = operation;
    this.maxRetries = maxRetries;
  }

  async execute() {
    let lastError;
    for (let attempt = 0; attempt &lt; this.maxRetries; attempt++) {
      try {
        return await new Promise(this.operation);
      } catch (error) {
        lastError = error;
        console.log(`Attempt ${attempt + 1} failed:`, error.message);
      }
    }
    throw lastError;
  }
}

// Использование
const unreliableOperation = new Retryable((resolve, reject) =&gt; {
  if (Math.random() &lt; 0.7) {
    reject(new Error('Random failure'));
  } else {
    resolve('Success!');
  }
}, 5);

unreliableOperation.execute()
  .then(result =&gt; console.log(result))
  .catch(error =&gt; console.error('Failed after retries:', error));
</code></pre>
<h3 id="пример-3-debounced-stream"><a class="header" href="#пример-3-debounced-stream">Пример 3: Debounced Stream</a></h3>
<pre><code class="language-javascript">const { Transform } = require('node:stream');

function createDebouncedStream(delay) {
  let timeoutId = null;
  let bufferedChunk = null;

  return new Transform({
    transform(chunk, encoding, callback) {
      // Сбрасываем предыдущий таймер
      if (timeoutId) {
        clearTimeout(timeoutId);
      }

      // Буферизуем chunk
      bufferedChunk = chunk;

      // Устанавливаем новый таймер
      timeoutId = setTimeout(() =&gt; {
        this.push(bufferedChunk);
        callback();
      }, delay);
    },

    flush(callback) {
      // Отправляем последний chunk при завершении
      if (timeoutId) {
        clearTimeout(timeoutId);
      }
      if (bufferedChunk) {
        this.push(bufferedChunk);
      }
      callback();
    }
  });
}

// Использование
const debouncedStream = createDebouncedStream(500);
process.stdin
  .pipe(debouncedStream)
  .pipe(process.stdout);
</code></pre>
<hr>
<h2 id="контрольные-вопросы"><a class="header" href="#контрольные-вопросы">Контрольные вопросы</a></h2>
<ol>
<li>В чём основное отличие между передачей константы и callback-функции в конструктор?</li>
<li>Почему Promise не может использовать простую функцию вместо callback для инициализации?</li>
<li>Какие преимущества даёт Revealing Constructor по сравнению с наследованием классов?</li>
<li>Приведите три примера использования этого паттерна в стандартной библиотеке Node.js</li>
<li>Как Revealing Constructor связан с паттерном Dependency Injection?</li>
</ol>
<hr>
<p><strong>Автор конспекта:</strong> Создано на основе лекции о паттерне Revealing Constructor
<strong>Тема курса:</strong> Паттерны проектирования в Node.js и JavaScript
<strong>Следующая тема:</strong> Паттерн Future для работы с асинхронностью</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../week3/flyweight-pattern-lecture-notes.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../week4.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../week3/flyweight-pattern-lecture-notes.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../week4.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>


        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
