<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>üí°Errors and exceptions, operational, soft, hard, recovery, logging - Patterns</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Patterns</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="–ü–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–æ–±—Ä–∞–±–æ—Ç–∫–µ-–æ—à–∏–±–æ–∫-–≤-javascript-–∏-nodejs"><a class="header" href="#–ü–æ–ª–Ω–æ–µ-—Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ-–ø–æ-–æ–±—Ä–∞–±–æ—Ç–∫–µ-–æ—à–∏–±–æ–∫-–≤-javascript-–∏-nodejs">–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫ –≤ JavaScript –∏ Node.js</a></h1>
<h2 id="–í–≤–µ–¥–µ–Ω–∏–µ-–ü–æ—á–µ–º—É-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–∫—Ä–∏—Ç–∏—á–Ω–∞"><a class="header" href="#–í–≤–µ–¥–µ–Ω–∏–µ-–ü–æ—á–µ–º—É-–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–∫—Ä–∏—Ç–∏—á–Ω–∞">–í–≤–µ–¥–µ–Ω–∏–µ: –ü–æ—á–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∫—Ä–∏—Ç–∏—á–Ω–∞</a></h2>
<p>–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚Äî —ç—Ç–æ <strong>–æ–¥–Ω–∞ –∏–∑ —Ç—Ä—ë—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</strong>, –Ω–∞—Ä–∞–≤–Ω–µ —Å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –ù–∞ –Ω–µ—ë –º–æ–∂–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å—Å—è –¥–æ 30% –æ—Ç –æ–±—â–µ–≥–æ –æ–±—ä—ë–º–∞ —Ä–∞–±–æ—Ç—ã –≤ production-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.</p>
<p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≥–æ–¥—ã –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –æ–ø–∞—Å–Ω–∞—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è: —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞—á–∏–Ω–∞—é—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫–∏ –∫–∞–∫ —á–∞—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ (–ø–∞—Ç—Ç–µ—Ä–Ω Go), –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ—à–∏–±–∫–∏ –∏ —É—Å–ª–æ–∂–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É.</p>
<hr />
<h2 id="–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–æ—à–∏–±–æ–∫"><a class="header" href="#–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è-–æ—à–∏–±–æ–∫">–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫</a></h2>
<h3 id="1-–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-operational-errors"><a class="header" href="#1-–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-operational-errors">1. –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (Operational Errors)</a></h3>
<p>–≠—Ç–æ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∏ —É—Å–ª–æ–≤–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ <strong>–º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã</strong> –∏ –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.</p>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong></p>
<ul>
<li>–°–æ–∫–µ—Ç –Ω–µ —Å–º–æ–≥ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</li>
<li>–§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω</li>
<li>–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö</li>
<li>–ò—Å—Ç–µ–∫–ª–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (timeout)</li>
<li>–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ –Ω–µ —Å–æ–≤–ø–∞–ª–∞</li>
</ul>
<p><strong>–°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:</strong></p>
<pre><code class="language-typescript">// Exponential backoff retry strategy
async function connectWithRetry(
  maxRetries: number = 5,
  delays: number[] = [5000, 5000, 20000, 60000, 600000]
): Promise&lt;Connection&gt; {
  for (let attempt = 0; attempt &lt; maxRetries; attempt++) {
    try {
      return await connectToDatabase();
    } catch (error) {
      if (attempt === maxRetries - 1) {
        throw new Error(`Failed to connect after ${maxRetries} attempts`, { 
          cause: error 
        });
      }
      
      const delay = delays[attempt] || delays[delays.length - 1];
      await sleep(delay);
    }
  }
}

function sleep(ms: number): Promise&lt;void&gt; {
  return new Promise(resolve =&gt; setTimeout(resolve, ms));
}
</code></pre>
<h3 id="2-–ú—è–≥–∫–∏–µ-–æ—à–∏–±–∫–∏-soft-errors"><a class="header" href="#2-–ú—è–≥–∫–∏–µ-–æ—à–∏–±–∫–∏-soft-errors">2. –ú—è–≥–∫–∏–µ –æ—à–∏–±–∫–∏ (Soft Errors)</a></h3>
<p>–≠—Ç–æ <strong>–æ–∂–∏–¥–∞–µ–º—ã–µ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è</strong>, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏. –ò—Ö –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∫–∞–∫ <code>throw</code>.</p>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong></p>
<ul>
<li>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
<li>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å</li>
<li>–°–∫–ª–∞–¥ —Å –Ω–æ–º–µ—Ä–æ–º 18 –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ</li>
<li>–ì–æ—Ä–æ–¥ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</li>
<li>–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
</ul>
<p><strong>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:</strong></p>
<pre><code class="language-typescript">interface UserResult {
  success: boolean;
  user?: User;
  error?: string;
}

async function getUserById(userId: string): Promise&lt;UserResult&gt; {
  try {
    const user = await database.users.findById(userId);
    
    if (!user) {
      return {
        success: false,
        error: 'User not found'
      };
    }
    
    return {
      success: true,
      user
    };
  } catch (error) {
    // –≠—Ç–æ —É–∂–µ —Å–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞!
    throw new Error('Failed to retrieve user', { cause: error });
  }
}
</code></pre>
<h3 id="3-–ñ—ë—Å—Ç–∫–∏–µ-–æ—à–∏–±–∫–∏-hard-errors"><a class="header" href="#3-–ñ—ë—Å—Ç–∫–∏–µ-–æ—à–∏–±–∫–∏-hard-errors">3. –ñ—ë—Å—Ç–∫–∏–µ –æ—à–∏–±–∫–∏ (Hard Errors)</a></h3>
<p>–≠—Ç–æ <strong>runtime-–æ—à–∏–±–∫–∏</strong>, –∫–æ—Ç–æ—Ä—ã–µ <strong>–≤—Å–µ–≥–¥–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –æ—Ç–∫–∞–∑—É</strong> –∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã:</p>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong></p>
<ul>
<li>–û–±—Ä–∞—â–µ–Ω–∏–µ –∫ –º–µ—Ç–æ–¥—É, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</li>
<li>–ß—Ç–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ —É <code>undefined</code></li>
<li>–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ</li>
<li>TypeError –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏</li>
<li>Division by zero –≤ JavaScript</li>
</ul>
<p><strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> –ñ—ë—Å—Ç–∫–∏–µ –æ—à–∏–±–∫–∏ <strong>–î–û–õ–ñ–ù–´ –±—ã—Ç—å –≤—ã–±—Ä–æ—à–µ–Ω—ã –∫–∞–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏—è</strong>.</p>
<pre><code class="language-typescript">// –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - –ø–æ–ø—ã—Ç–∞–µ–º—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ
const value = unknownObject.nonExistentMethod(); // –í—ã–∑–æ–≤–µ—Ç TypeError

// –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –æ—à–∏–±–∫–∞ –≤—ã–±—Ä–æ—Å–∏—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–µ–Ω—å, –≥–¥–µ –µ—ë –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å
function processData(data: unknown): void {
  if (!data || typeof data !== 'object') {
    throw new TypeError('Expected object, got ' + typeof data);
  }
  
  // –¢–µ–ø–µ—Ä—å safe –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å data –∫–∞–∫ object
  const result = (data as Record&lt;string, any&gt;).method?.();
}
</code></pre>
<h3 id="4-–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ--–î–æ–º–µ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-domain-errors"><a class="header" href="#4-–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ--–î–æ–º–µ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-domain-errors">4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ / –î–æ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (Domain Errors)</a></h3>
<p>–≠—Ç–æ –æ—à–∏–±–∫–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.</p>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong></p>
<ul>
<li>–ù–µ–ª—å–∑—è –≤—ã–¥–∞—Ç—å –ø–æ—Å—ã–ª–∫—É: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</li>
<li>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞</li>
<li>–ü—Ä–µ–≤—ã—à–µ–Ω–∞ –∫–≤–æ—Ç–∞ –Ω–∞ —á–∏—Å–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤</li>
<li>–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–∞ –ø–æ –ø–æ–ª–∏—Ç–∏–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>
</ul>
<p><strong>–ü—Ä–∞–≤–∏–ª–æ:</strong> –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –≤ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –Ω—É–∂–µ–Ω <strong>–æ–¥–∏–Ω –∫–ª–∞—Å—Å –æ—à–∏–±–∫–∏</strong>.</p>
<pre><code class="language-typescript">// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - 150 –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
class UserNotFoundError extends Error {}
class WarehouseNotFoundError extends Error {}
class PaymentFailedError extends Error {}
// ... –∏ –µ—â—ë 147 –∫–ª–∞—Å—Å–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –æ–¥–∏–Ω –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
class DomainError extends Error {
  constructor(
    public code: string,
    message: string,
    public context?: Record&lt;string, any&gt;
  ) {
    super(message);
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
throw new DomainError('USER_NOT_FOUND', 'User with ID 123 not found', {
  userId: 123
});
</code></pre>
<hr />
<h2 id="–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è-–æ—à–∏–±–æ–∫-–º–µ–∂–¥—É-—Å–ª–æ—è–º–∏-error-escalation"><a class="header" href="#–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è-–æ—à–∏–±–æ–∫-–º–µ–∂–¥—É-—Å–ª–æ—è–º–∏-error-escalation">–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ (Error Escalation)</a></h2>
<h3 id="–ü—Ä–æ–±–ª–µ–º–∞"><a class="header" href="#–ü—Ä–æ–±–ª–µ–º–∞">–ü—Ä–æ–±–ª–µ–º–∞</a></h3>
<p>–ö–æ–≥–¥–∞ –æ—à–∏–±–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ—ë–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –æ—à–∏–±–∫—É.</p>
<pre><code class="language-typescript">// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–¢–û–ö
// –°–ª–æ–π —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã: "File not found"
// ‚Üí –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º: "File not found"  
// ‚Üí –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: "File not found"
// ‚Üí Frontend: "File not found"  ‚Üê –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—É—é –æ—à–∏–±–∫—É!
</code></pre>
<h3 id="–†–µ—à–µ–Ω–∏–µ"><a class="header" href="#–†–µ—à–µ–Ω–∏–µ">–†–µ—à–µ–Ω–∏–µ</a></h3>
<p>–ö–∞–∂–¥—ã–π —Å–ª–æ–π –¥–æ–ª–∂–µ–Ω <strong>–æ–±–µ—Ä–Ω—É—Ç—å</strong> —Å–∏—Å—Ç–µ–º–Ω—É—é –æ—à–∏–±–∫—É –≤ –¥–æ–º–µ–Ω–Ω—É—é.</p>
<pre><code class="language-typescript">// –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º (Data Layer)
async function loadUserProfile(userId: string): Promise&lt;UserProfile&gt; {
  try {
    const content = await fs.readFile(`./profiles/${userId}.json`);
    return JSON.parse(content);
  } catch (error) {
    // –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º —Ñ–∞–π–ª–æ–≤—É—é –æ—à–∏–±–∫—É –≤ –¥–æ–º–µ–Ω–Ω—É—é
    if ((error as NodeJS.ErrnoException).code === 'ENOENT') {
      throw new DomainError(
        'PROFILE_NOT_FOUND',
        `User profile not found for ID: ${userId}`,
        { userId, cause: error }
      );
    }
    
    if (error instanceof SyntaxError) {
      throw new DomainError(
        'INVALID_PROFILE_DATA',
        'User profile data is corrupted',
        { userId, cause: error }
      );
    }
    
    throw error;
  }
}

// –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Application Layer)
async function authenticateUser(userId: string): Promise&lt;AuthResult&gt; {
  try {
    const profile = await loadUserProfile(userId);
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    if (!profile.isActive) {
      return {
        success: false,
        code: 'USER_INACTIVE',
        message: 'Account is inactive'
      };
    }
    return { success: true, profile };
  } catch (error) {
    if (error instanceof DomainError &amp;&amp; error.code === 'PROFILE_NOT_FOUND') {
      return {
        success: false,
        code: 'AUTHENTICATION_FAILED',
        message: 'Invalid credentials' // Generic message for security!
      };
    }
    throw error;
  }
}

// –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä / API (Presentation Layer)
app.post('/login', async (req, res) =&gt; {
  try {
    const result = await authenticateUser(req.body.userId);
    
    if (!result.success) {
      return res.status(401).json({
        error: result.message,
        code: result.code
      });
    }
    
    res.json({ user: result.profile });
  } catch (error) {
    // –õ–æ–≥–∏—Ä—É–µ–º –ø–æ–ª–Ω—É—é –æ—à–∏–±–∫—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    logger.error('Authentication error:', {
      error,
      userId: req.body.userId,
      timestamp: new Date()
    });
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≥–µ–Ω–µ—Ä–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    res.status(500).json({
      error: 'Authentication service unavailable',
      code: 'SERVICE_ERROR'
    });
  }
});
</code></pre>
<hr />
<h2 id="–¶–µ–ø–æ—á–∫–∏-–æ—à–∏–±–æ–∫-error-chains"><a class="header" href="#–¶–µ–ø–æ—á–∫–∏-–æ—à–∏–±–æ–∫-error-chains">–¶–µ–ø–æ—á–∫–∏ –æ—à–∏–±–æ–∫ (Error Chains)</a></h2>
<h3 id="errorcause---–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π-—Å–ø–æ—Å–æ–±"><a class="header" href="#errorcause---–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π-—Å–ø–æ—Å–æ–±">Error.cause - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±</a></h3>
<pre><code class="language-typescript">async function processPayment(orderId: string): Promise&lt;void&gt; {
  try {
    await chargeCard(orderId);
  } catch (error) {
    // –°–æ–∑–¥–∞—ë–º —Ü–µ–ø–æ—á–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    throw new Error(
      `Failed to process payment for order ${orderId}`,
      { cause: error }
    );
  }
}

async function fulfillOrder(orderId: string): Promise&lt;void&gt; {
  try {
    await processPayment(orderId);
  } catch (error) {
    throw new Error(
      `Failed to fulfill order ${orderId}`,
      { cause: error }
    );
  }
}

// –ü—Ä–∏ –æ—à–∏–±–∫–µ —Å—Ç–µ–∫ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å—é —Ü–µ–ø–æ—á–∫—É:
// Error: Failed to fulfill order 123
//   cause: Error: Failed to process payment for order 123
//     cause: Error: Card declined
</code></pre>
<h3 id="aggregateerror---–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏"><a class="header" href="#aggregateerror---–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏">AggregateError - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏</a></h3>
<pre><code class="language-typescript">async function fetchUserData(userId: string): Promise&lt;UserData&gt; {
  const errors: Error[] = [];
  let profile: Profile | null = null;
  let permissions: Permission[] | null = null;
  
  try {
    [profile, permissions] = await Promise.allSettled([
      fetchProfile(userId),
      fetchPermissions(userId)
    ]).then(results =&gt; 
      results.map((result, index) =&gt; {
        if (result.status === 'rejected') {
          errors.push(result.reason);
          return null;
        }
        return result.value;
      })
    );
  } catch (error) {
    errors.push(error as Error);
  }
  
  if (errors.length &gt; 0) {
    throw new AggregateError(
      errors,
      `Failed to fetch user data for ${userId}`
    );
  }
  
  if (!profile || !permissions) {
    throw new Error('Incomplete user data');
  }
  
  return { profile, permissions };
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞
try {
  const userData = await fetchUserData('123');
} catch (error) {
  if (error instanceof AggregateError) {
    console.log(`Multiple errors occurred: ${error.message}`);
    error.errors.forEach((err, index) =&gt; {
      console.log(`Error ${index + 1}:`, err.message);
    });
  }
}
</code></pre>
<hr />
<h2 id="–ü—Ä–∞–∫—Ç–∏–∫–∏-–æ–±—Ä–∞–±–æ—Ç–∫–∏-–æ—à–∏–±–æ–∫"><a class="header" href="#–ü—Ä–∞–∫—Ç–∏–∫–∏-–æ–±—Ä–∞–±–æ—Ç–∫–∏-–æ—à–∏–±–æ–∫">–ü—Ä–∞–∫—Ç–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫</a></h2>
<h3 id="1-early-return-fail-fast"><a class="header" href="#1-early-return-fail-fast">1. Early Return (Fail Fast)</a></h3>
<pre><code class="language-typescript">async function processOrder(order: Order): Promise&lt;void&gt; {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —É—Å–ª–æ–≤–∏—è –≤ –Ω–∞—á–∞–ª–µ
  if (!order.customerId) {
    throw new Error('Order must have customer ID');
  }
  
  if (order.items.length === 0) {
    throw new Error('Order cannot be empty');
  }
  
  if (order.total &lt; 0) {
    throw new Error('Order total cannot be negative');
  }
  
  // –¢–µ–ø–µ—Ä—å –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ–º —Å order
  await validateInventory(order.items);
  await processPayment(order);
  await shipOrder(order);
}
</code></pre>
<h3 id="2-either--result-–ø–∞—Ç—Ç–µ—Ä–Ω"><a class="header" href="#2-either--result-–ø–∞—Ç—Ç–µ—Ä–Ω">2. Either / Result –ø–∞—Ç—Ç–µ—Ä–Ω</a></h3>
<pre><code class="language-typescript">// Right/Left –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
type Either&lt;L, R&gt; = { tag: 'left'; value: L } | { tag: 'right'; value: R };

function createEither&lt;L, R&gt;(
  value: R | null,
  error: L | null
): Either&lt;L, R&gt; {
  if (value !== null) {
    return { tag: 'right', value };
  }
  return { tag: 'left', value: error as L };
}

async function getUserWithEither(
  userId: string
): Promise&lt;Either&lt;Error, User&gt;&gt; {
  try {
    const user = await fetchUser(userId);
    return createEither(user, null);
  } catch (error) {
    return createEither(null, error as Error);
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const result = await getUserWithEither('123');
if (result.tag === 'right') {
  console.log('User found:', result.value);
} else {
  console.error('Error:', result.value.message);
}
</code></pre>
<h3 id="3-try-catch-vs-promise-chain"><a class="header" href="#3-try-catch-vs-promise-chain">3. Try-Catch vs Promise Chain</a></h3>
<pre><code class="language-typescript">// Try-Catch (—è–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–∞)
async function processWithTryCatch(): Promise&lt;void&gt; {
  try {
    const data = await fetchData();
    const processed = await process(data);
    const result = await save(processed);
    return result;
  } catch (error) {
    if (isNetworkError(error)) {
      retry();
    } else if (isValidationError(error)) {
      logAndNotify(error);
    } else {
      rethrow(error);
    }
  } finally {
    cleanup();
  }
}

// Promise Chain (—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å)
function processWithPromiseChain(): Promise&lt;void&gt; {
  return fetchData()
    .then(process)
    .then(save)
    .catch((error) =&gt; {
      if (isNetworkError(error)) return retry();
      if (isValidationError(error)) return logAndNotify(error);
      throw error;
    })
    .finally(cleanup);
}
</code></pre>
<p><strong>–†–∞–∑–Ω–∏—Ü–∞:</strong> Try-catch —Ä–∞–±–æ—Ç–∞–µ—Ç —Å <strong>—Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏</strong> (pending, fulfilled, rejected), –∞ Promise chain —É–ø—Ä–∞–≤–ª—è–µ—Ç <strong>–ø–æ—Ç–æ–∫–æ–º –¥–∞–Ω–Ω—ã—Ö</strong>. –£ try-catch –µ—Å—Ç—å <code>finally</code>, —á—Ç–æ —É–¥–æ–±–Ω–µ–µ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.</p>
<hr />
<h2 id="–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–æ—à–∏–±–æ–∫-–∏-—Ç—Ä–µ–π—Å–∏–Ω–≥"><a class="header" href="#–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–æ—à–∏–±–æ–∫-–∏-—Ç—Ä–µ–π—Å–∏–Ω–≥">–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏ —Ç—Ä–µ–π—Å–∏–Ω–≥</a></h2>
<h3 id="–°—Ç—Ä–∞—Ç–µ–≥–∏—è-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è"><a class="header" href="#–°—Ç—Ä–∞—Ç–µ–≥–∏—è-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è">–°—Ç—Ä–∞—Ç–µ–≥–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è</a></h3>
<pre><code class="language-typescript">interface ErrorLog {
  id: string; // UUID –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞
  timestamp: string;
  severity: 'critical' | 'error' | 'warning' | 'info';
  code: string;
  message: string;
  stack?: string;
  context: Record&lt;string, any&gt;;
  userId?: string; // Anon –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
  requestId?: string;
}

class ErrorLogger {
  log(error: Error, context: Record&lt;string, any&gt;): ErrorLog {
    const id = generateUUID();
    const errorLog: ErrorLog = {
      id,
      timestamp: new Date().toISOString(),
      severity: this.determineSeverity(error),
      code: (error as any).code || 'UNKNOWN',
      message: error.message,
      stack: error.stack,
      context: this.sanitizeContext(context)
    };
    
    // –õ–æ–≥–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ (–ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
    this.writeToFile(errorLog);
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å (–æ—á–∏—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
    this.sendToLoggingService({
      ...errorLog,
      stack: undefined, // –ù–µ —à–ª—ë–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏
      context: this.filterSensitiveData(errorLog.context)
    });
    
    return errorLog;
  }
  
  private sanitizeContext(context: Record&lt;string, any&gt;): Record&lt;string, any&gt; {
    // –£–¥–∞–ª—è–µ–º –ø–∞—Ä–æ–ª–∏, —Ç–æ–∫–µ–Ω—ã, etc.
    const { password, token, creditCard, ssn, ...safe } = context;
    return safe;
  }
  
  private filterSensitiveData(context: Record&lt;string, any&gt;): Record&lt;string, any&gt; {
    return Object.fromEntries(
      Object.entries(context).map(([key, value]) =&gt; [
        key,
        typeof value === 'string' &amp;&amp; value.length &gt; 50 ? '[redacted]' : value
      ])
    );
  }
  
  private determineSeverity(error: Error): ErrorLog['severity'] {
    if (error instanceof DomainError) return 'warning';
    if ((error as any).code === 'ECONNREFUSED') return 'error';
    return 'critical';
  }
  
  private writeToFile(log: ErrorLog): void {
    // –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ —Ä–∞–∑–º–µ—Ä—É
    fs.appendFileSync('./logs/errors.json', JSON.stringify(log) + '\n');
  }
  
  private sendToLoggingService(log: ErrorLog): void {
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ ElasticSearch, Datadog, CloudWatch, etc.
    fetch('https://logging.service/api/errors', {
      method: 'POST',
      body: JSON.stringify(log)
    }).catch(err =&gt; console.error('Failed to log error:', err));
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å ID —Ç—Ä–µ–π—Å–∏–Ω–≥–∞
app.use((req, res, next) =&gt; {
  req.id = generateUUID();
  next();
});

app.post('/pay', async (req, res) =&gt; {
  try {
    const result = await processPayment(req.body);
    res.json(result);
  } catch (error) {
    const log = errorLogger.log(error as Error, {
      userId: req.user?.id,
      requestId: req.id,
      orderId: req.body.orderId,
      timestamp: new Date()
    });
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º ID –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    res.status(500).json({
      error: 'Payment processing failed',
      errorId: log.id // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–ª—è support
    });
  }
});
</code></pre>
<hr />
<h2 id="–û–±—Ä–∞–±–æ—Ç–∫–∞-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö-–æ—à–∏–±–æ–∫"><a class="header" href="#–û–±—Ä–∞–±–æ—Ç–∫–∞-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö-–æ—à–∏–±–æ–∫">–û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫</a></h2>
<h3 id="unhandled-promise-rejection"><a class="header" href="#unhandled-promise-rejection">Unhandled Promise Rejection</a></h3>
<pre><code class="language-typescript">// –ü—Ä–æ–±–ª–µ–º–∞: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ callback —Ç–µ—Ä—è–µ—Ç—Å—è
const emitter = new EventEmitter();

emitter.on('data', async (data) =&gt; {
  throw new Error('Async error in callback'); // –ö—É–¥–∞ –¥–µ–ª–∞—Å—å —ç—Ç–∞ –æ—à–∏–±–∫–∞?
});

// –†–µ—à–µ–Ω–∏–µ 1: –Ø–≤–Ω—ã–π try-catch –≤–Ω—É—Ç—Ä–∏ callback
emitter.on('data', async (data) =&gt; {
  try {
    await processData(data);
  } catch (error) {
    emitter.emit('error', error);
  }
});

// –†–µ—à–µ–Ω–∏–µ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å capture-rejections
const emitter = new EventEmitter({ captureRejections: true });

emitter.on('data', async (data) =&gt; {
  throw new Error('Now this is caught!');
});

emitter.on('error', (error) =&gt; {
  console.error('Caught error:', error);
});

// –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—Å–µ—Ö —ç–º–∏—Ç—Ç–µ—Ä–æ–≤
EventEmitter.captureRejections = true;

// –†–µ—à–µ–Ω–∏–µ 3: –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ unhandled rejection
process.on('unhandledRejection', (reason, promise) =&gt; {
  console.error('Unhandled Rejection:', reason);
  logger.error('Unhandled rejection', { reason, promise });
  // –í production –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
});

process.on('uncaughtException', (error) =&gt; {
  console.error('Uncaught Exception:', error);
  logger.error('Uncaught exception', { error });
  // –í–ê–ñ–ù–û: –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
  process.exit(1);
});
</code></pre>
<hr />
<h2 id="–°—Ç—Ä–∞—Ç–µ–≥–∏–∏-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è-recovery-strategies"><a class="header" href="#–°—Ç—Ä–∞—Ç–µ–≥–∏–∏-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è-recovery-strategies">–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è (Recovery Strategies)</a></h2>
<h3 id="–ú–æ–¥–µ–ª—å-–∏–∑–æ–ª—è—Ü–∏–∏"><a class="header" href="#–ú–æ–¥–µ–ª—å-–∏–∑–æ–ª—è—Ü–∏–∏">–ú–æ–¥–µ–ª—å –∏–∑–æ–ª—è—Ü–∏–∏</a></h3>
<pre><code class="language-typescript">// 1. –ù–∞–∏–±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ: –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
// –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ production
process.on('uncaughtException', () =&gt; {
  gracefulShutdown();
  process.exit(1);
});

// 2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ç–æ–∫–∞ (Worker Threads)
// –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è —Ç—è–∂—ë–ª—ã—Ö –æ–±—Ä–∞–±–æ—Ç–æ–∫
function createWorkerPool(size: number): void {
  const workers: Worker[] = [];
  
  for (let i = 0; i &lt; size; i++) {
    const worker = new Worker('./worker.js');
    
    worker.on('error', () =&gt; {
      workers.splice(workers.indexOf(worker), 1);
      // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π worker –≤–º–µ—Å—Ç–æ —É–ø–∞–≤—à–µ–≥–æ
      workers.push(new Worker('./worker.js'));
    });
    
    workers.push(worker);
  }
}

// 3. –ò–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –∑–∞–º—ã–∫–∞–Ω–∏–µ (V8 Snapshot)
class IsolatedContext {
  private snapshot: any = {};
  
  execute(fn: Function): Result {
    try {
      const result = fn();
      return { success: true, result };
    } catch (error) {
      // –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–µ—Ç—Ä–æ–Ω—É—Ç—ã–º (–≤ –∑–∞–º—ã–∫–∞–Ω–∏–∏)
      return { success: false, error };
    }
  }
}

// 4. –î–µ—à–µ–≤–æ: –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—ä–µ–∫—Ç–∞
class Operation {
  private state: Record&lt;string, any&gt; = {};
  
  process(): void {
    try {
      this.doSomething();
    } catch (error) {
      // –¢–æ–ª—å–∫–æ this.state –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–≤—Ä–µ–∂–¥—ë–Ω, –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ safe
    }
  }
}

// 5. –ü–æ—á—Ç–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ: –∑–∞–º—ã–∫–∞–Ω–∏–µ
function createOperation() {
  const localState = {};
  
  return {
    process() {
      try {
        // —Ä–∞–±–æ—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ —Å localState
      } catch (error) {
        // localState –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –∑–∞–º—ã–∫–∞–Ω–∏–∏
      }
    }
  };
}
</code></pre>
<hr />
<h2 id="–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∏-–º–∏–≥—Ä–∞—Ü–∏—è-deployment-strategies"><a class="header" href="#–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ-–∏-–º–∏–≥—Ä–∞—Ü–∏—è-deployment-strategies">–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏—è (Deployment Strategies)</a></h2>
<h3 id="canary-release"><a class="header" href="#canary-release">Canary Release</a></h3>
<pre><code class="language-typescript">// –§–∏—á–∞ —Ñ–ª–∞–≥ —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º
const featureFlags = {
  newPaymentSystem: {
    enabled: true,
    canaryPercentage: 5 // –¢–æ–ª—å–∫–æ 5% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  }
};

function shouldUseNewPayment(userId: string): boolean {
  const hash = parseInt(userId.slice(0, 8), 16);
  const percentage = hash % 100;
  
  return percentage &lt; featureFlags.newPaymentSystem.canaryPercentage;
}

app.post('/pay', async (req, res) =&gt; {
  const useNewSystem = shouldUseNewPayment(req.user.id);
  
  try {
    if (useNewSystem) {
      return res.json(await newPaymentService.process(req.body));
    } else {
      return res.json(await oldPaymentService.process(req.body));
    }
  } catch (error) {
    // –ï—Å–ª–∏ –Ω–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∞–¥–∞–µ—Ç, —Å—Ä–∞–∑—É –æ—Ç–∫–ª—é—á–∞–µ–º –¥–ª—è –≤—Å–µ—Ö
    if (useNewSystem) {
      featureFlags.newPaymentSystem.enabled = false;
      // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Å—Ç–∞—Ä—É—é
      return res.json(await oldPaymentService.process(req.body));
    }
    throw error;
  }
});
</code></pre>
<h3 id="blue-green-deploy"><a class="header" href="#blue-green-deploy">Blue-Green Deploy</a></h3>
<pre><code class="language-typescript">const currentDeployment = {
  blue: { version: '1.0.0', traffic: 100 },
  green: { version: '1.1.0', traffic: 0 }
};

function getActiveServer(): Server {
  if (currentDeployment.blue.traffic &gt; 0) {
    return blueServer;
  }
  return greenServer;
}

async function gradualMigration(): Promise&lt;void&gt; {
  // 10% ‚Üí green
  currentDeployment.green.traffic = 10;
  currentDeployment.blue.traffic = 90;
  
  await monitorMetrics(5 * 60 * 1000); // 5 –º–∏–Ω—É—Ç
  
  if (noErrorsDetected()) {
    // 100% ‚Üí green
    currentDeployment.green.traffic = 100;
    currentDeployment.blue.traffic = 0;
  } else {
    // –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º—Å—è
    rollbackDeployment();
  }
}
</code></pre>
<h3 id="fallback-strategy"><a class="header" href="#fallback-strategy">Fallback Strategy</a></h3>
<pre><code class="language-typescript">async function getExchangeRate(currency: string): Promise&lt;number&gt; {
  const cacheKey = `rate:${currency}`;
  
  try {
    // –ü–æ–ø—ã—Ç–∫–∞ 1: –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫
    return await externalAPI.getRate(currency);
  } catch (error) {
    logger.error('Primary source failed', { currency, error });
    
    // –ü–æ–ø—ã—Ç–∫–∞ 2: –†–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
    try {
      return await backupAPI.getRate(currency);
    } catch (backupError) {
      logger.error('Backup source failed', { currency, error: backupError });
      
      // –ü–æ–ø—ã—Ç–∫–∞ 3: –ö—ç—à
      const cached = cache.get(cacheKey);
      if (cached) {
        logger.warn('Using cached rate', { currency, age: Date.now() - cached.timestamp });
        return cached.value;
      }
      
      // –ü–æ–ø—ã—Ç–∫–∞ 4: –ò–∑ –ë–î (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –¥–∞–Ω–Ω—ã–µ)
      const historical = await database.getLastKnownRate(currency);
      if (historical) {
        logger.warn('Using historical rate', { currency, date: historical.date });
        return historical.value;
      }
      
      // –í—Å—ë –ø–ª–æ—Ö–æ - –±—Ä–æ—Å–∞–µ–º –æ—à–∏–±–∫—É
      throw new Error(`Cannot get exchange rate for ${currency}`);
    }
  }
}
</code></pre>
<hr />
<h2 id="–¢–∏–ø–∏—á–Ω—ã–µ-–æ—à–∏–±–∫–∏-–∏-–∫–∞–∫-–∏—Ö-–∏–∑–±–µ–∂–∞—Ç—å"><a class="header" href="#–¢–∏–ø–∏—á–Ω—ã–µ-–æ—à–∏–±–∫–∏-–∏-–∫–∞–∫-–∏—Ö-–∏–∑–±–µ–∂–∞—Ç—å">–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å</a></h2>
<h3 id="-–ü—Ä–æ–±–ª–µ–º–∞-–ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-–∫–∞—Å—Ç–æ–º–Ω—ã—Ö-–æ—à–∏–±–æ–∫"><a class="header" href="#-–ü—Ä–æ–±–ª–µ–º–∞-–ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ-–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ-–∫–∞—Å—Ç–æ–º–Ω—ã—Ö-–æ—à–∏–±–æ–∫">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –æ—à–∏–±–æ–∫</a></h3>
<pre><code class="language-typescript">// –ü–õ–û–•–û: 150 –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
class UserNotFoundError extends Error {}
class ProductNotFoundError extends Error {}
class OrderNotFoundError extends Error {}
class WarehouseNotFoundError extends Error {}
// ... –µ—â—ë 146 –∫–ª–∞—Å—Å–æ–≤

// –•–û–†–û–®–û: –û–¥–∏–Ω –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ–π –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
class NotFoundError extends Error {
  constructor(resourceType: string, resourceId: any) {
    super(`${resourceType} not found: ${resourceId}`);
    this.code = 'NOT_FOUND';
  }
}
</code></pre>
<h3 id="-–ü—Ä–æ–±–ª–µ–º–∞-–£—Ç–µ—á–∫–∞-–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö-–æ—à–∏–±–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é"><a class="header" href="#-–ü—Ä–æ–±–ª–µ–º–∞-–£—Ç–µ—á–∫–∞-–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö-–æ—à–∏–±–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –£—Ç–µ—á–∫–∞ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é</a></h3>
<pre><code class="language-typescript">// –ü–õ–û–•–û: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∏–º—è –ø–æ–ª—è –ë–î
app.get('/users/:id', async (req, res) =&gt; {
  try {
    const user = await db.query(
      'SELECT * FROM users WHERE user_id = ?',
      [req.params.id]
    );
    res.json(user);
  } catch (error) {
    res.status(500).json({ error: error.message }); // –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å 'foreign key constraint'
  }
});

// –•–û–†–û–®–û: –ì–µ–Ω–µ—Ä–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
app.get('/users/:id', async (req, res) =&gt; {
  try {
    const user = await db.query(
      'SELECT * FROM users WHERE user_id = ?',
      [req.params.id]
    );
    res.json(user);
  } catch (error) {
    logger.error('User fetch failed', { error, userId: req.params.id });
    res.status(500).json({ 
      error: 'Unable to retrieve user information',
      errorId: generateErrorId()
    });
  }
});
</code></pre>
<h3 id="-–ü—Ä–æ–±–ª–µ–º–∞-–ü–æ—Ç–µ—Ä—è-stack-trace"><a class="header" href="#-–ü—Ä–æ–±–ª–µ–º–∞-–ü–æ—Ç–µ—Ä—è-stack-trace">‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ç–µ—Ä—è stack trace</a></h3>
<pre><code class="language-typescript">// –ü–õ–û–•–û: Stack trace —Ç–µ—Ä—è–µ—Ç—Å—è
try {
  await operation();
} catch (error) {
  throw 'Something went wrong'; // String –≤–º–µ—Å—Ç–æ Error!
}

// –ü–õ–û–•–û: Error –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –±–µ–∑ —Ü–µ–ø–æ—á–∫–∏
const error1 = new Error('first');
const error2 = new Error('second');
throw error2; // –ü–æ—Ç–µ—Ä—è–ª–∏ error1

// –•–û–†–û–®–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º Error.cause
try {
  await operation();
} catch (error) {
  throw new Error('Operation failed', { cause: error });
}
</code></pre>
<hr />
<h2 id="–ó–∞–∫–ª—é—á–µ–Ω–∏–µ"><a class="header" href="#–ó–∞–∫–ª—é—á–µ–Ω–∏–µ">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></h2>
<p>–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚Äî —ç—Ç–æ –∏—Å–∫—É—Å—Å—Ç–≤–æ –±–∞–ª–∞–Ω—Å–∞ –º–µ–∂–¥—É:</p>
<ul>
<li><strong>–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å—é</strong>: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –æ—Ç —Å–±–æ–µ–≤</li>
<li><strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é</strong>: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏</li>
<li><strong>–û—Ç–ª–∞–¥–∫–æ–π</strong>: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É</li>
<li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é</strong>: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–º–µ–¥–ª—è—Ç—å —Å–∏—Å—Ç–µ–º—É</li>
</ul>
<p>–ü–æ–º–Ω–∏—Ç–µ: <strong>–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ ‚Äî —ç—Ç–æ 30% –≤–∞—à–µ–π —Ä–∞–±–æ—Ç—ã</strong>. –ò–Ω–≤–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ–µ–∫—Ç–∞.</p>
<h1 id="–ü—Ä–∏–º–µ—Ä—ã-–∫–æ–¥–∞-–û–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–≤-javascripttypescript"><a class="header" href="#–ü—Ä–∏–º–µ—Ä—ã-–∫–æ–¥–∞-–û–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫-–≤-javascripttypescript">–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ JavaScript/TypeScript</a></h1>
<h2 id="1-–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è-–æ—à–∏–±–∫–∞-–∏-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ"><a class="header" href="#1-–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è-–æ—à–∏–±–∫–∞-–∏-–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ">1: –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</a></h2>
<pre><code class="language-typescript">async function fetchWithExponentialBackoff(
  url: string,
  maxAttempts: number = 5
): Promise&lt;Response&gt; {
  const baseDelay = 1000; // 1 —Å–µ–∫—É–Ω–¥–∞
  
  for (let attempt = 0; attempt &lt; maxAttempts; attempt++) {
    try {
      console.log(`–ü–æ–ø—ã—Ç–∫–∞ ${attempt + 1} –∏–∑ ${maxAttempts}...`);
      return await fetch(url, { timeout: 5000 });
    } catch (error) {
      if (attempt === maxAttempts - 1) {
        throw new Error(
          `–°–µ—Ç—å –º–æ–ª—á–∏—Ç –ø–æ—Å–ª–µ ${maxAttempts} –ø–æ–ø—ã—Ç–æ–∫`,
          { cause: error }
        );
      }
      
      // –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 1s, 2s, 4s, 8s, 16s
      const delayMs = baseDelay * Math.pow(2, attempt);
      console.log(`–ñ–¥—É ${delayMs}ms –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–æ–º...`);
      await new Promise(resolve =&gt; setTimeout(resolve, delayMs));
    }
  }
  
  throw new Error('Impossible branch');
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
try {
  const response = await fetchWithExponentialBackoff('https://api.example.com/data');
  console.log('‚ú® –£—Å–ø–µ—Ö! –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã');
} catch (error) {
  console.error('üíî –°–µ—Ç—å –Ω–µ –æ—Ç–æ–∑–≤–∞–ª–∞—Å—å:', (error as Error).message);
}
</code></pre>
<hr />
<h2 id="–°–æ–Ω–µ—Ç-2-–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è-–æ—à–∏–±–æ–∫-–º–µ–∂–¥—É-—Å–ª–æ—è–º–∏"><a class="header" href="#–°–æ–Ω–µ—Ç-2-–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è-–æ—à–∏–±–æ–∫-–º–µ–∂–¥—É-—Å–ª–æ—è–º–∏">–°–æ–Ω–µ—Ç 2: –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏</a></h2>
<pre><code class="language-typescript">class UserProfileService {
  async getUserProfile(userId: string): Promise&lt;UserProfile&gt; {
    try {
      // –£—Ä–æ–≤–µ–Ω—å 1: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (–Ω–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
      const profilePath = `./data/users/${userId}/profile.json`;
      const fileContent = await fs.promises.readFile(profilePath, 'utf-8');
      
      // –£—Ä–æ–≤–µ–Ω—å 2: –ü–∞—Ä—Å–∏–Ω–≥ JSON
      try {
        return JSON.parse(fileContent);
      } catch (parseError) {
        // –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º JSON –æ—à–∏–±–∫—É –≤ –¥–æ–º–µ–Ω–Ω—É—é
        throw new DomainError(
          'CORRUPTED_PROFILE_DATA',
          `–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId} –ø–æ–≤—Ä–µ–∂–¥—ë–Ω`,
          { userId, cause: parseError }
        );
      }
    } catch (fileError) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø —Ñ–∞–π–ª–æ–≤–æ–π –æ—à–∏–±–∫–∏
      const nodeError = fileError as NodeJS.ErrnoException;
      
      if (nodeError.code === 'ENOENT') {
        // –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –≤ –±–∏–∑–Ω–µ—Å-–æ—à–∏–±–∫—É
        throw new DomainError(
          'USER_NOT_FOUND',
          `–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId} –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç`,
          { userId, systemError: 'ENOENT' }
        );
      }
      
      if (nodeError.code === 'EACCES') {
        // –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ ‚Üí —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –≤ –æ—à–∏–±–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        throw new DomainError(
          'SECURITY_ERROR',
          '–ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ—Ñ–∏–ª—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è',
          { userId, systemError: 'EACCES' }
        );
      }
      
      // –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ ‚Üí –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã—à–µ
      throw new DomainError(
        'SYSTEM_ERROR',
        '–°–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–æ—Ñ–∏–ª—è',
        { userId, cause: fileError }
      );
    }
  }
}

// –£—Ä–æ–≤–µ–Ω—å 3: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)
class AuthenticationService {
  constructor(private profileService: UserProfileService) {}
  
  async authenticate(userId: string): Promise&lt;AuthResult&gt; {
    try {
      const profile = await this.profileService.getUserProfile(userId);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –∞–∫–∫–∞—É–Ω—Ç
      if (!profile.isActive) {
        return {
          success: false,
          code: 'ACCOUNT_INACTIVE',
          message: '–ê–∫–∫–∞—É–Ω—Ç –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω'
        };
      }
      
      return { success: true, profile };
    } catch (error) {
      if (error instanceof DomainError) {
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–æ–º–µ–Ω–Ω—É—é –æ—à–∏–±–∫—É –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        return {
          success: false,
          code: 'AUTH_FAILED',
          message: '–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' // –ì–µ–Ω–µ—Ä–∏—á–µ—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        };
      }
      
      // –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ ‚Üí –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã—à–µ
      throw error;
    }
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const authService = new AuthenticationService(new UserProfileService());

try {
  const result = await authService.authenticate('user123');
  if (result.success) {
    console.log('‚ú® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!', result.profile.name);
  } else {
    console.log('‚ùå', result.message);
  }
} catch (error) {
  console.error('üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', (error as Error).message);
}
</code></pre>
<hr />
<h2 id="3-–¶–µ–ø–æ—á–∫–∞-–æ—à–∏–±–æ–∫-error-chain"><a class="header" href="#3-–¶–µ–ø–æ—á–∫–∞-–æ—à–∏–±–æ–∫-error-chain">3: –¶–µ–ø–æ—á–∫–∞ –æ—à–∏–±–æ–∫ (Error Chain)</a></h2>
<pre><code class="language-typescript">class PaymentProcessor {
  async processPayment(orderId: string, amount: number): Promise&lt;void&gt; {
    try {
      await this.chargeCard(orderId, amount);
    } catch (error) {
      // –£—Ä–æ–≤–µ–Ω—å 1: –ü–ª–∞—Ç—ë–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª–∞
      throw new Error(
        `–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç—ë–∂ –¥–ª—è –∑–∞–∫–∞–∑–∞ ${orderId}`,
        { cause: error }
      );
    }
  }
  
  private async chargeCard(orderId: string, amount: number): Promise&lt;void&gt; {
    try {
      const response = await fetch('https://payment-gateway.com/charge', {
        method: 'POST',
        body: JSON.stringify({ orderId, amount })
      });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}`);
      }
    } catch (error) {
      // –£—Ä–æ–≤–µ–Ω—å 2: –°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –ø–ª–∞—Ç—ë–∂–Ω–æ–º—É —à–ª—é–∑—É
      throw new Error(
        '–ü–ª–∞—Ç—ë–∂–Ω—ã–π —à–ª—é–∑ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω',
        { cause: error }
      );
    }
  }
}

class OrderService {
  constructor(private paymentProcessor: PaymentProcessor) {}
  
  async fulfillOrder(orderId: string, amount: number): Promise&lt;void&gt; {
    try {
      await this.paymentProcessor.processPayment(orderId, amount);
    } catch (error) {
      // –£—Ä–æ–≤–µ–Ω—å 3: –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–∫–∞–∑
      throw new Error(
        `–ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–∫–∞–∑ ${orderId}`,
        { cause: error }
      );
    }
  }
}

// –í—ã–≤–æ–¥ –ø–æ–ª–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ –æ—à–∏–±–æ–∫
function printErrorChain(error: Error): void {
  let current: Error | undefined = error;
  let level = 0;
  
  while (current) {
    console.log('  '.repeat(level) + `‚Üí ${current.message}`);
    current = (current as any).cause;
    level++;
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const orderService = new OrderService(new PaymentProcessor());

try {
  await orderService.fulfillOrder('ORDER-123', 9999);
} catch (error) {
  console.error('–¶–µ–ø–æ—á–∫–∞ –æ—à–∏–±–æ–∫:');
  printErrorChain(error as Error);
  
  /**
   * –í—ã–≤–æ–¥:
   * –¶–µ–ø–æ—á–∫–∞ –æ—à–∏–±–æ–∫:
   * ‚Üí –ù–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–∫–∞–∑ ORDER-123
   *   ‚Üí –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç—ë–∂ –¥–ª—è –∑–∞–∫–∞–∑–∞ ORDER-123
   *     ‚Üí –ü–ª–∞—Ç—ë–∂–Ω—ã–π —à–ª—é–∑ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω
   *       ‚Üí TypeError: fetch failed
   */
}
</code></pre>
<hr />
<h2 id="4-aggregateerror--–º–Ω–æ–∂–µ—Å—Ç–≤–æ-–±–µ–¥"><a class="header" href="#4-aggregateerror--–º–Ω–æ–∂–µ—Å—Ç–≤–æ-–±–µ–¥">4: AggregateError ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –±–µ–¥</a></h2>
<pre><code class="language-typescript">interface UserData {
  profile: UserProfile;
  permissions: Permission[];
  preferences: Preferences;
}

async function fetchUserDataComplete(userId: string): Promise&lt;UserData&gt; {
  const errors: Error[] = [];
  const results = await Promise.allSettled([
    fetchUserProfile(userId),
    fetchUserPermissions(userId),
    fetchUserPreferences(userId)
  ]);
  
  let profile: UserProfile | null = null;
  let permissions: Permission[] | null = null;
  let preferences: Preferences | null = null;
  
  for (let i = 0; i &lt; results.length; i++) {
    const result = results[i];
    
    if (result.status === 'rejected') {
      errors.push(result.reason);
    } else {
      if (i === 0) profile = result.value;
      else if (i === 1) permissions = result.value;
      else if (i === 2) preferences = result.value;
    }
  }
  
  // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ ‚Äî –≤—ã–±—Ä–æ—Å–∏–º AggregateError
  if (errors.length &gt; 0) {
    throw new AggregateError(
      errors,
      `–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId}`
    );
  }
  
  if (!profile || !permissions || !preferences) {
    throw new Error('–ù–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
  }
  
  return { profile, permissions, preferences };
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ AggregateError
try {
  const userData = await fetchUserDataComplete('user-123');
  console.log('‚ú® –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ');
} catch (error) {
  if (error instanceof AggregateError) {
    console.error(`‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–æ ${error.errors.length} –æ—à–∏–±–æ–∫:`);
    
    for (let i = 0; i &lt; error.errors.length; i++) {
      const err = error.errors[i];
      console.error(`  ${i + 1}. ${(err as Error).message}`);
    }
    
    // –ü—Ä–∏–º–µ—Ä: –∑–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ –∫—ç—à–∞ –µ—Å–ª–∏ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
    const cachedProfile = getCachedUserData('user-123');
    console.log('üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', cachedProfile);
  } else {
    console.error('üí• –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', (error as Error).message);
  }
}
</code></pre>
<hr />
<h2 id="–°–æ–Ω–µ—Ç-5-–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-—Å-id-—Ç—Ä–µ–π—Å–∏–Ω–≥–∞"><a class="header" href="#–°–æ–Ω–µ—Ç-5-–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-—Å-id-—Ç—Ä–µ–π—Å–∏–Ω–≥–∞">–°–æ–Ω–µ—Ç 5: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ID —Ç—Ä–µ–π—Å–∏–Ω–≥–∞</a></h2>
<pre><code class="language-typescript">interface ErrorContext {
  errorId: string;
  requestId: string;
  userId?: string;
  timestamp: string;
  severity: 'critical' | 'error' | 'warning';
  message: string;
  code: string;
  stack?: string;
  context: Record&lt;string, any&gt;;
}

class AdvancedErrorLogger {
  private log(errorContext: ErrorContext): void {
    // –õ–æ–≥–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω–æ (–ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å stack trace)
    const localEntry = {
      ...errorContext,
      timestamp: new Date().toISOString()
    };
    
    console.error('üìã [LOCAL LOG]', JSON.stringify(localEntry, null, 2));
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å (–æ—á–∏—â–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
    this.sendToRemoteService({
      ...errorContext,
      stack: undefined, // –ù–µ —à–ª—ë–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏
      context: this.filterSensitiveFields(errorContext.context)
    });
  }
  
  private filterSensitiveFields(data: Record&lt;string, any&gt;): Record&lt;string, any&gt; {
    const sensitive = ['password', 'token', 'creditCard', 'ssn', 'apiKey'];
    
    return Object.fromEntries(
      Object.entries(data).map(([key, value]) =&gt; [
        key,
        sensitive.includes(key) ? '[REDACTED]' : value
      ])
    );
  }
  
  private sendToRemoteService(context: Partial&lt;ErrorContext&gt;): void {
    // –í production ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ DataDog, ElasticSearch, CloudWatch, –∏ —Ç.–¥.
    console.log('‚òÅÔ∏è  [REMOTE]', {
      errorId: context.errorId,
      requestId: context.requestId,
      message: context.message,
      code: context.code
    });
  }
  
  captureError(
    error: Error,
    context: Partial&lt;ErrorContext&gt;
  ): string {
    const errorId = this.generateUUID();
    
    const fullContext: ErrorContext = {
      errorId,
      requestId: context.requestId || 'unknown',
      userId: context.userId,
      timestamp: new Date().toISOString(),
      severity: (context.severity || 'error') as any,
      message: error.message,
      code: (error as any).code || 'UNKNOWN',
      stack: error.stack,
      context: context.context || {}
    };
    
    this.log(fullContext);
    return errorId;
  }
  
  private generateUUID(): string {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) =&gt; {
      const r = Math.random() * 16 | 0;
      const v = c === 'x' ? r : (r &amp; 0x3 | 0x8);
      return v.toString(16);
    });
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
const errorLogger = new AdvancedErrorLogger();

app.use((req, res, next) =&gt; {
  req.id = generateUUID(); // –î–æ–±–∞–≤–ª—è–µ–º ID –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  next();
});

app.post('/orders/:orderId/payment', async (req, res) =&gt; {
  try {
    const payment = await processPayment(req.params.orderId, req.body);
    res.json({ success: true, payment });
  } catch (error) {
    const errorId = errorLogger.captureError(error as Error, {
      requestId: req.id,
      userId: req.user?.id,
      severity: 'error',
      context: {
        orderId: req.params.orderId,
        amount: req.body.amount,
        method: 'POST'
      }
    });
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º ID –æ—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    res.status(500).json({
      error: '–ü–ª–∞—Ç—ë–∂ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç',
      errorId, // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–ª—è support
      message: '–û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ —Å–ª—É–∂–± –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏: ' + errorId
    });
  }
});

// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ—Å–ª–µ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å support: "–£ –º–µ–Ω—è –±—ã–ª–∞ –æ—à–∏–±–∫–∞ 550e8400-e29b-41d4-a716-446655440000"
// –ê support —Å—Ä–∞–∑—É –Ω–∞–π–¥—ë—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ —Å–∏—Å—Ç–µ–º–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
</code></pre>
<hr />
<h2 id="–°–æ–Ω–µ—Ç-6-–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-–≤-eventemitter"><a class="header" href="#–°–æ–Ω–µ—Ç-6-–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ-–æ—à–∏–±–∫–∏-–≤-eventemitter">–°–æ–Ω–µ—Ç 6: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ EventEmitter</a></h2>
<pre><code class="language-typescript">class DataProcessor extends EventEmitter {
  constructor() {
    super({
      captureRejections: true // –õ–æ–≤–∏–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏!
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—Å–µ—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–º–∏—Å–æ–≤
    this.on('error', (error) =&gt; {
      console.error('üî• –ü–æ–π–º–∞–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞:', error.message);
      this.logError(error);
    });
  }
  
  processDataBatch(items: any[]): void {
    // –≠—Ç–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ë–£–î–ï–¢ –ø–æ–π–º–∞–Ω–∞ –±–ª–∞–≥–æ–¥–∞—Ä—è captureRejections
    this.on('item', async (item) =&gt; {
      if (!item.id) {
        throw new Error(`Item –±–µ–∑ ID: ${JSON.stringify(item)}`);
      }
      
      await this.saveToDatabase(item);
      this.emit('itemProcessed', item);
    });
    
    for (const item of items) {
      this.emit('item', item);
    }
  }
  
  private async saveToDatabase(item: any): Promise&lt;void&gt; {
    // –ò–º–∏—Ç–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
    return new Promise((resolve) =&gt; setTimeout(resolve, 100));
  }
  
  private logError(error: Error): void {
    console.error('üìù –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –≤ —Å–∏—Å—Ç–µ–º—É:', {
      message: error.message,
      stack: error.stack
    });
  }
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
const processor = new DataProcessor();

processor.on('itemProcessed', (item) =&gt; {
  console.log('‚úÖ –≠–ª–µ–º–µ–Ω—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω:', item.id);
});

processor.processDataBatch([
  { id: 1, data: 'first' },
  { id: 2, data: 'second' },
  { data: 'third' }, // ‚ùå –û—à–∏–±–∫–∞! –ù–µ—Ç ID, –±—É–¥–µ—Ç –ø–æ–π–º–∞–Ω–∞
  { id: 4, data: 'fourth' }
]);

/**
 * –ë–µ–∑ captureRejections: –æ—à–∏–±–∫–∞ –ø–æ—Ç–µ—Ä—è–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏
 * –° captureRejections: –æ—à–∏–±–∫–∞ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ 'error' –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ
 */
</code></pre>
<hr />
<h2 id="7-–ü–∞—Ç—Ç–µ—Ä–Ω-either-–¥–ª—è-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ-—Å—Ç–∏–ª—è"><a class="header" href="#7-–ü–∞—Ç—Ç–µ—Ä–Ω-either-–¥–ª—è-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ-—Å—Ç–∏–ª—è">7: –ü–∞—Ç—Ç–µ—Ä–Ω Either –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∏–ª—è</a></h2>
<pre><code class="language-typescript">
// Either type –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
type Either&lt;L, R&gt; = 
  | { tag: 'left'; value: L }
  | { tag: 'right'; value: R };

function left&lt;L, R&gt;(value: L): Either&lt;L, R&gt; {
  return { tag: 'left', value };
}

function right&lt;L, R&gt;(value: R): Either&lt;L, R&gt; {
  return { tag: 'right', value };
}

// –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Either
const Either = {
  map: &lt;L, R1, R2&gt;(
    either: Either&lt;L, R1&gt;,
    fn: (value: R1) =&gt; R2
  ): Either&lt;L, R2&gt; =&gt; {
    return either.tag === 'right'
      ? right(fn(either.value))
      : either;
  },
  
  flatMap: &lt;L, R1, R2&gt;(
    either: Either&lt;L, R1&gt;,
    fn: (value: R1) =&gt; Either&lt;L, R2&gt;
  ): Either&lt;L, R2&gt; =&gt; {
    return either.tag === 'right'
      ? fn(either.value)
      : either;
  },
  
  fold: &lt;L, R, A&gt;(
    either: Either&lt;L, R&gt;,
    onLeft: (value: L) =&gt; A,
    onRight: (value: R) =&gt; A
  ): A =&gt; {
    return either.tag === 'left'
      ? onLeft(either.value)
      : onRight(either.value);
  }
};

// –ü—Ä–∏–º–µ—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏—Ö Either

function parseJSON(str: string): Either&lt;Error, any&gt; {
  try {
    return right(JSON.parse(str));
  } catch (error) {
    return left(error as Error);
  }
}

async function fetchUser(userId: string): Promise&lt;Either&lt;Error, User&gt;&gt; {
  try {
    const response = await fetch(`/api/users/${userId}`);
    if (!response.ok) {
      return left(new Error(`HTTP ${response.status}`));
    }
    const user = await response.json();
    return right(user);
  } catch (error) {
    return left(error as Error);
  }
}

function validateUser(user: User): Either&lt;Error, User&gt; {
  if (!user.email) {
    return left(new Error('Email is required'));
  }
  if (user.email.indexOf('@') === -1) {
    return left(new Error('Invalid email format'));
  }
  return right(user);
}

// –ö–æ–º–ø–æ–∑–∏—Ü–∏—è Either –æ–ø–µ—Ä–∞—Ü–∏–π
async function loadAndValidateUser(userId: string): Promise&lt;Either&lt;Error, User&gt;&gt; {
  const result = await fetchUser(userId);
  
  if (result.tag === 'left') {
    return result;
  }
  
  return validateUser(result.value);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
loadAndValidateUser('user-123').then(result =&gt; {
  Either.fold(
    result,
    // onLeft ‚Äî —á—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
    (error) =&gt; {
      console.error('‚ùå –û—à–∏–±–∫–∞:', error.message);
      return 'FAILURE';
    },
    // onRight ‚Äî —á—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —É—Å–ø–µ—Ö
    (user) =&gt; {
      console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω:', user.name);
      return 'SUCCESS';
    }
  );
});

// –ë–æ–ª–µ–µ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ —Å —Ü–µ–ø–æ—á–∫–æ–π –æ–ø–µ—Ä–∞—Ü–∏–π
loadAndValidateUser('user-123').then(result =&gt; {
  const message = Either.fold(
    result,
    (error) =&gt; `‚ùå –û—à–∏–±–∫–∞: ${error.message}`,
    (user) =&gt; `‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.name}!`
  );
  console.log(message);
});
</code></pre>
<hr />
<h2 id="8-graceful-shutdown-–ø—Ä–∏-–æ—à–∏–±–∫–∞—Ö"><a class="header" href="#8-graceful-shutdown-–ø—Ä–∏-–æ—à–∏–±–∫–∞—Ö">8: Graceful Shutdown –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö</a></h2>
<pre><code class="language-typescript">
class Application {
  private db: DatabaseConnection | null = null;
  private server: Server | null = null;
  private requestCount = 0;
  private isShuttingDown = false;
  
  async start(): Promise&lt;void&gt; {
    // –ü–æ–¥–∫–ª—é—á–∞–µ–º—Å—è –∫ –ë–î
    this.db = await DatabaseConnection.create();
    
    // –°–æ–∑–¥–∞—ë–º —Å–µ—Ä–≤–µ—Ä
    this.server = createServer(async (req, res) =&gt; {
      if (this.isShuttingDown) {
        res.writeHead(503, { 'Retry-After': '30' });
        res.end('Service is shutting down');
        return;
      }
      
      this.requestCount++;
      try {
        await this.handleRequest(req, res);
      } finally {
        this.requestCount--;
      }
    });
    
    this.server.listen(3000, () =&gt; {
      console.log('üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000');
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –û–°
    process.on('SIGTERM', () =&gt; this.gracefulShutdown('SIGTERM'));
    process.on('SIGINT', () =&gt; this.gracefulShutdown('SIGINT'));
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
    process.on('uncaughtException', (error) =&gt; {
      console.error('üí• –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:', error);
      this.gracefulShutdown('uncaughtException');
    });
    
    process.on('unhandledRejection', (reason) =&gt; {
      console.error('‚ö†Ô∏è  –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ:', reason);
      this.gracefulShutdown('unhandledRejection');
    });
  }
  
  private async handleRequest(req: any, res: any): Promise&lt;void&gt; {
    try {
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
      res.writeHead(200, { 'Content-Type': 'application/json' });
      res.end(JSON.stringify({ status: 'ok' }));
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞:', error);
      res.writeHead(500);
      res.end('Internal Server Error');
    }
  }
  
  private async gracefulShutdown(signal: string): Promise&lt;void&gt; {
    if (this.isShuttingDown) return;
    
    this.isShuttingDown = true;
    console.log(`\nüõë –ü–æ–ª—É—á–µ–Ω —Å–∏–≥–Ω–∞–ª: ${signal}`);
    console.log('üìç –ù–∞—á–∏–Ω–∞–µ–º graceful shutdown...');
    
    // –®–∞–≥ 1: –ü—Ä–µ–∫—Ä–∞—â–∞–µ–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
    this.server?.close(() =&gt; {
      console.log('‚úì –°–µ—Ä–≤–µ—Ä –∑–∞–∫—Ä—ã—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π');
    });
    
    // –®–∞–≥ 2: –û–∂–∏–¥–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–º–∞–∫—Å 30 —Å–µ–∫)
    const shutdownTimeout = setTimeout(() =&gt; {
      console.error('‚ùå Timeout –ø—Ä–∏ shutdown, –≤—ã—Ö–æ–¥–∏–º');
      process.exit(1);
    }, 30000);
    
    const waitInterval = setInterval(() =&gt; {
      console.log(`‚è≥ –û–∂–∏–¥–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ${this.requestCount} –∑–∞–ø—Ä–æ—Å–æ–≤...`);
      
      if (this.requestCount === 0) {
        clearInterval(waitInterval);
        clearTimeout(shutdownTimeout);
        
        // –®–∞–≥ 3: –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
        this.db?.close().then(() =&gt; {
          console.log('‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∑–∞–∫—Ä—ã—Ç–æ');
          console.log('‚úì Graceful shutdown –∑–∞–≤–µ—Ä—à—ë–Ω');
          process.exit(0);
        });
      }
    }, 1000);
  }
}

// –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
const app = new Application();
app.start().catch((error) =&gt; {
  console.error('üí• –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
  process.exit(1);
});
</code></pre>
<hr />
<h2 id="–ó–∞–∫–ª—é—á–µ–Ω–∏–µ-1"><a class="header" href="#–ó–∞–∫–ª—é—á–µ–Ω–∏–µ-1">–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a></h2>
<p>–ö–∞–∂–¥—ã–π —Å–æ–Ω–µ—Ç –∏–ª–ª—é—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –∞—Å–ø–µ–∫—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:</p>
<ol>
<li><strong>–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</strong> ‚Äî exponential backoff</li>
<li><strong>–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è</strong> ‚Äî –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</li>
<li><strong>–¶–µ–ø–æ—á–∫–∏</strong> ‚Äî Error.cause –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</li>
<li><strong>–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏</strong> ‚Äî AggregateError</li>
<li><strong>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</strong> ‚Äî —Å ID —Ç—Ä–µ–π—Å–∏–Ω–≥–∞</li>
<li><strong>–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏</strong> ‚Äî captureRejections</li>
<li><strong>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å</strong> ‚Äî Either –ø–∞—Ç—Ç–µ—Ä–Ω</li>
<li><strong>–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ</strong> ‚Äî graceful shutdown</li>
</ol>
<p>–≠—Ç–∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç <strong>–Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å</strong>, <strong>–æ—Ç–ª–∞–¥–∫—É</strong> –∏ <strong>–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</strong> –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../prerequisites/js-course-2024.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../prerequisites/native-contracts-lecture.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../prerequisites/js-course-2024.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../prerequisites/native-contracts-lecture.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
